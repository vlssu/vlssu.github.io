import{_ as s,o as a,c as e,e as n}from"./app-54_SznpJ.js";const l={},i=n(`<h2 id="首次部署时" tabindex="-1"><a class="header-anchor" href="#首次部署时"><span>首次部署时</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /data/docker /var/lib/docker</span>
<span class="line"><span class="token function">ln</span> <span class="token parameter variable">-s</span> /data/docker /var/lib/docker</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="已有数据迁移时" tabindex="-1"><a class="header-anchor" href="#已有数据迁移时"><span>已有数据迁移时</span></a></h2><ol><li>暂停docker服务</li></ol><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">systemctl stop <span class="token function">docker</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看dokcer服务是否停止完毕</span></span>
<span class="line">systemctl status <span class="token function">docker</span></span>
<span class="line"><span class="token function">ps</span> <span class="token parameter variable">-fe</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>拷贝/var/lib目录到挂载目录</li></ol><p>挂载目录以<code>/data</code>为例</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">cp</span> <span class="token parameter variable">-r</span> /var/lib/docker /data/docker</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="3"><li>备份原有数据</li></ol><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">mv</span> /var/lib/docker /var/lib/docker_bk</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="4"><li>创建软链接</li></ol><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">ln</span> <span class="token parameter variable">-s</span> /data/docker /var/lib/docker</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看软链接是否生效</span></span>
<span class="line">ll /var/lib/docker</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>启动docker服务</li></ol><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">systemctl start <span class="token function">docker</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="6"><li>查看容器是否正常拉起</li></ol><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">docker</span> <span class="token function">ps</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="7"><li>删掉备份目录</li></ol><p>如果迁移成功，可以删除备份的目录</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/docker_bk</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,19),t=[i];function r(c,d){return a(),e("div",null,t)}const o=s(l,[["render",r],["__file","230831.html.vue"]]),u=JSON.parse('{"path":"/blogs/notes/230831.html","title":"Docker 软链接及迁移数据","lang":"zh-CN","frontmatter":{"title":"Docker 软链接及迁移数据","date":"2023-08-31T00:00:00.000Z","tags":["Docker"],"categories":["笔记"]},"headers":[{"level":2,"title":"首次部署时","slug":"首次部署时","link":"#首次部署时","children":[]},{"level":2,"title":"已有数据迁移时","slug":"已有数据迁移时","link":"#已有数据迁移时","children":[]}],"git":{"createdTime":1693451120000,"updatedTime":1696267043000,"contributors":[{"name":"飒爽师叔","email":"43847794+vlssu@users.noreply.github.com","commits":2}]},"filePathRelative":"blogs/notes/230831.md"}');export{o as comp,u as data};
