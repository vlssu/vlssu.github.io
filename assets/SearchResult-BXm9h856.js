import{g as V,u as W,h as X,i as Z,j as ee,t as se,k as te,l as B,m as b,n as e,p as ae,q as le,s as ie,R as $,v as re,x as ne,y as oe,z as ce,A as ue,B as _,C as j,D as he,E as ve,F as me,G as de,L as ge,H as pe,I as ye,J as we,K as T,M as xe,N as k}from"./app-CioNCLUN.js";const fe=["/","/intro.html","/views/deploy-website/flarum.html","/views/deploy-website/frp.html","/views/deploy-website/img_upyun_php.html","/views/deploy-website/imgapi.html","/views/deploy-website/nextcloud.html","/views/deploy-website/node.html","/views/deploy-website/pterodactyl.html","/views/deploy-website/pterodactyl_docker.html","/views/deploy-website/yutto.html","/views/notes/210209.html","/views/notes/210913.html","/views/notes/220601.html","/views/notes/220925.html","/views/notes/230831.html","/views/tech-sharing/linux/aliyuncli-ssl.html","/views/tech-sharing/linux/apache-mod_remoteip.html","/views/tech-sharing/linux/chrome.html","/views/tech-sharing/linux/docker.html","/views/tech-sharing/linux/go.html","/views/tech-sharing/linux/instruction.html","/views/tech-sharing/linux/java8.html","/views/tech-sharing/linux/nginx-cdn-ip.html","/views/tech-sharing/linux/node.html","/views/tech-sharing/linux/python3.9.html","/views/tech-sharing/linux/selinux.html","/views/tech-sharing/minecraft/bds-server.html","/views/tech-sharing/minecraft/java-server.html","/views/tech-sharing/minecraft/mcsm.html","/views/tech-sharing/minecraft/mcsm9.html","/views/tech-sharing/minecraft/netplus.html","/views/tech-sharing/node/vuepress-blog-on-github.html","/views/tech-sharing/vuepress/markdown.html","/404.html","/views/deploy-website/","/views/","/views/notes/","/views/tech-sharing/linux/","/views/tech-sharing/","/views/tech-sharing/minecraft/","/views/tech-sharing/node/","/views/tech-sharing/vuepress/","/category/","/category/%E6%95%99%E7%A8%8B/","/category/%E7%AC%94%E8%AE%B0/","/category/linux%E4%BD%BF%E7%94%A8%E5%B0%8F%E7%9F%A5%E8%AF%86/","/category/vuepress/","/tag/","/tag/flarum/","/tag/centos/","/tag/linux/","/tag/ubuntu/","/tag/windows/","/tag/frp/","/tag/upyum/","/tag/php/","/tag/%E5%AE%9D%E5%A1%94/","/tag/nextcloud/","/tag/node/","/tag/npm/","/tag/pterodactyl/","/tag/%E7%BF%BC%E9%BE%99/","/tag/%E6%B1%89%E5%8C%96/","/tag/python/","/tag/yutto/","/tag/fastutil/","/tag/%E6%95%B0%E6%8E%A7%E7%BC%96%E7%A8%8B%E6%8C%87%E4%BB%A4/","/tag/mysql/","/tag/docker/","/tag/1panel/","/tag/apache/","/tag/cdn/","/tag/chrome/","/tag/go/","/tag/liunx/","/tag/java/","/tag/nginx/","/tag/minecraft/","/tag/server/","/tag/mcsm/","/tag/vlssuskin/","/tag/markdown/","/tag/vuepress/","/article/","/star/","/timeline/"],Ee="SLIMSEARCH_QUERY_HISTORY",y=T(Ee,[]),be=()=>{const{queryHistoryCount:l}=k;return{enabled:l>0,queryHistories:y,addQueryHistory:o=>{y.value=Array.from(new Set([o,...y.value.slice(0,l-1)]))},removeQueryHistory:o=>{y.value=[...y.value.slice(0,o),...y.value.slice(o+1)]}}},S=l=>fe[l.id]+("anchor"in l?`#${l.anchor}`:""),ke="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:I}=k,w=T(ke,[]),He=()=>({enabled:I>0,resultHistories:w,addResultHistory:n=>{{const o={link:S(n),display:n.display};"header"in n&&(o.header=n.header),w.value=[o,...w.value.slice(0,I-1)]}},removeResultHistory:n=>{w.value=[...w.value.slice(0,n),...w.value.slice(n+1)]}}),Ae=l=>{const{page:n,routeLocale:o}=he(),H=ve(),i=B(0),x=b(()=>i.value>0),h=me([]);return de(()=>{const{search:A,terminate:d}=ge(),f=ye(g=>{const{resultsFilter:C=a=>a,querySplitter:p,suggestionsFilter:F,...r}=H.value;g?(i.value+=1,A(g,o.value,r).then(a=>C(a,g,o.value,n.value)).then(a=>{i.value-=1,h.value=a}).catch(a=>{console.warn(a),i.value-=1,i.value||(h.value=[])})):h.value=[]},k.searchDelay-k.suggestDelay,{maxWait:5e3});pe([l,o],([g])=>f(g.join(" "))),we(()=>{d()})}),{isSearching:x,results:h}};var Re=V({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:n}){const o=W(),H=X(),i=Z(ee),{addQueryHistory:x,queryHistories:h,removeQueryHistory:A}=be(),{resultHistories:d,addResultHistory:f,removeResultHistory:g}=He(),C=se(l,"queries"),{results:p,isSearching:F}=Ae(C),r=te({isQuery:!0,index:0}),a=B(0),v=B(0),L=b(()=>h.value.length>0||d.value.length>0),R=b(()=>p.value.length>0),Q=b(()=>p.value[a.value]||null),M=()=>{const{isQuery:s,index:t}=r;t===0?(r.isQuery=!s,r.index=s?d.value.length-1:h.value.length-1):r.index=t-1},U=()=>{const{isQuery:s,index:t}=r;t===(s?h.value.length-1:d.value.length-1)?(r.isQuery=!s,r.index=0):r.index=t+1},O=()=>{a.value=a.value>0?a.value-1:p.value.length-1,v.value=Q.value.contents.length-1},P=()=>{a.value=a.value<p.value.length-1?a.value+1:0,v.value=0},Y=()=>{v.value<Q.value.contents.length-1?v.value+=1:P()},z=()=>{v.value>0?v.value-=1:O()},q=s=>s.map(t=>xe(t)?t:e(t[0],t[1])),G=s=>{if(s.type==="customField"){const t=ce[s.index]||"$content",[m,c=""]=ue(t)?t[H.value].split("$content"):t.split("$content");return s.display.map(u=>e("div",q([m,...u,c])))}return s.display.map(t=>e("div",q(t)))},E=()=>{a.value=0,v.value=0,n("updateQuery",""),n("close")},J=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},i.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},h.value.map((s,t)=>{const m=r.isQuery&&r.index===t;return e("li",{class:["slimsearch-record-matches",{active:m}],role:"option","aria-selected":m,onClick:()=>{n("updateQuery",s)}},e("div",[e(_,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},s),e("button",{type:"button",class:"slimsearch-remove-icon",title:i.value.remove,"aria-label":i.value.remove,innerHTML:j,onClick:c=>{c.preventDefault(),c.stopPropagation(),A(t)}})]))}))])),K=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},i.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},d.value.map((s,t)=>{const m=!r.isQuery&&r.index===t;return e("li",{class:["slimsearch-record-matches",{active:m}],role:"option","aria-selected":m},e($,{to:s.link,onClick:()=>{E()}},()=>[e(_,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[s.header?e("div",{class:"slimsearch-record-content-header"},s.header):null,e("div",s.display.map(c=>q(c)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:i.value.remove,"aria-label":i.value.remove,innerHTML:j,onClick:c=>{c.preventDefault(),c.stopPropagation(),g(t)}})]))}))]));return ae("keydown",s=>{if(l.isFocusing){if(R.value){if(s.key==="ArrowUp")z();else if(s.key==="ArrowDown")Y();else if(s.key==="Enter"){const t=Q.value.contents[v.value];x(l.queries.join(" ")),f(t),o.push(S(t)),E()}}else if(s.key==="ArrowUp")M();else if(s.key==="ArrowDown")U();else if(s.key==="Enter"){const{index:t}=r;r.isQuery?(s.preventDefault(),n("updateQuery",h.value[t])):(o.push(d.value[t].link),E())}}}),le([a,v],()=>{var s;(s=document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active"))==null||s.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:l.queries.length?!R.value:!L.value}]},l.queries.length?F.value?e(ie,{hint:i.value.searching}):R.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},p.value.map(({title:s,contents:t},m)=>{const c=a.value===m;return e("div",{class:["slimsearch-record",{active:c}],role:"group","aria-selected":c},[e("div",{class:"slimsearch-record-title"},s||i.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},t.map((u,N)=>{const D=c&&v.value===N;return e("li",{class:["slimsearch-record-matches",{active:D}],role:"option","aria-selected":D},e($,{to:S(u),onClick:()=>{x(l.queries.join(" ")),f(u),E()}},()=>[u.type==="text"?null:e(u.type==="title"?re:u.type==="heading"?ne:oe,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[u.type==="text"&&u.header?e("div",{class:"slimsearch-record-content-header"},u.header):null,e("div",G(u))])]))}))])})):i.value.emptyResult:L.value?[J(),K()]:i.value.emptyHistory)}});export{Re as default};
